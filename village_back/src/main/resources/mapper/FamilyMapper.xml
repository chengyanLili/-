<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.village_back.mapper.FamilyMapper">

    <update id="update">
        update `family`
        <set>
            <if test="memberName != null">
                memberName = #{memberName},
            </if>
            <if test="relation != null">
                relation = #{relation},
            </if>
            <if test="birthday != null">
                birthday = #{birthday},
            </if>
            <if test="memberIdCard != null">
                memberIdCard = #{memberIdCard},
            </if>
            <if test="accountNo != null">
                accountNo = #{accountNo},
            </if>
            <if test="householdName != null">
                householdName = #{householdName},
            </if>
            <if test="householdIdCard != null">
                householdIdCard = #{householdIdCard},
            </if>
            <if test="householdPhone != null">
                householdPhone = #{householdPhone},
            </if>
            <if test="inGroup != null">
                inGroup = #{inGroup},
            </if>
        </set>
        <where>
            familyId = #{familyId}
        </where>

    </update>
    <select  id = "deleteBatch" resultType="java.lang.Integer">
        delete  from  family where familyId in
        <foreach collection="familyIds"  item="item" index ="index" open="(" separator="," close=")">
            #{item}
        </foreach>
    </select>

    <select id="selectPage" resultType="com.example.village_back.entity.Family">
        SELECT * FROM family where relation = '户主'
        <!--           加这个<where></where>这个条件-->
        <where>
            <if test="householdName != null and householdName != ''">
                and householdName like concat('%',#{householdName},'%')
            </if>
        </where>
        LIMIT #{pageNum},#{pageSize}
    </select>

    <select id="selectTotal" resultType="java.lang.Long">
        SELECT count(familyId) from family where relation = '户主'
        <where>
            <if test="householdName != null and householdName != ''">
                and name like concat('%',#{householdName},'%')
            </if>
        </where>
    </select>


</mapper>
